{% extends "layout.html" %}

{% block title %}Quản lý Thành viên - {{ guild.name }}{% endblock %}

{% block content %}

<h1 class="main-title poetic-header">Quản lý Thành viên: {{ guild.name }}</h1>

<!-- form tim kiem -->
<form method="GET" action="{{ url_for('members', guild_id=guild.id) }}" class="search-container">
    <input type="search" name="search" class="search-input-poetic" placeholder="Tìm kiếm theo tên..." value="{{ search_query or '' }}">
    <button type="submit" class="poetic-button poetic-button-primary">Tìm</button>
</form>


<div class="server-grid">
    {% if members %}
        {% for member in members %}
            <a href="{{ url_for('edit_member', guild_id=guild.id, user_id=member.id) }}" class="server-card">
                <img src="{{ member.avatar_url }}" alt="Avatar" class="server-card-icon">
                <div class="server-card-info">
                    <h5>{{ member.name }}</h5>
                    <small>ID: {{ member.id }}</small>
                    <div class="member-card-balance">
                        <strong>{{ "{:,}".format(member.balance) }}</strong> coin
                    </div>
                </div>
            </a>
        {% endfor %}
    {% else %}
        <p style="text-align: center; grid-column: 1 / -1; font-size: 1.2rem;">Không tìm thấy thành viên nào.</p>
    {% endif %}
</div>

{% if total_pages > 1 %}
<nav class="pagination">
    {% if page > 1 %}
        <a href="{{ url_for('members', guild_id=guild.id, page=page-1, search=search_query) }}" class="poetic-button poetic-button-secondary">&laquo; Trang trước</a>
    {% endif %}
    <span style="align-self: center;">Trang {{ page }} / {{ total_pages }}</span>
    {% if page < total_pages %}
        <a href="{{ url_for('members', guild_id=guild.id, page=page+1, search=search_query) }}" class="poetic-button poetic-button-secondary">Trang sau &raquo;</a>
    {% endif %}
</nav>
{% endif %}

{% endblock %}